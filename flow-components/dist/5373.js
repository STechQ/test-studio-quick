"use strict";exports.id=5373,exports.ids=[5373],exports.modules={5373:(e,t,r)=>{r.r(t),r.d(t,{fromHttp:()=>ce});var o=r(174),n=r(3585);const s=e=>encodeURIComponent(e).replace(/[!'()*]/g,i),i=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`;var a=r(3685),c=r(5687);const f=["ECONNRESET","EPIPE","ETIMEDOUT"],u=e=>{const t={};for(const r of Object.keys(e)){const o=e[r];t[r]=Array.isArray(o)?o.join(","):o}return t},l={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e)};var h=r(2781);class p{static create(e){return"function"==typeof e?.handle?e:new p(e)}static checkSocketUsage(e,t,r=console){const{sockets:o,requests:n,maxSockets:s}=e;if("number"!=typeof s||s===1/0)return t;if(Date.now()-15e3<t)return t;if(o&&n)for(const e in o){const t=o[e]?.length??0,i=n[e]?.length??0;if(t>=s&&i>=2*s)return r?.warn?.(`@smithy/node-http-handler:WARN - socket usage at capacity=${t} and ${i} additional requests are enqueued.\nSee https://docs.aws.amazon.com/sdk-for-javascript/v3/developer-guide/node-configuring-maxsockets.html\nor increase socketAcquisitionWarningTimeout=(millis) in the NodeHttpHandler config.`),Date.now()}return t}constructor(e){this.socketWarningTimestamp=0,this.metadata={handlerProtocol:"http/1.1"},this.configProvider=new Promise(((t,r)=>{"function"==typeof e?e().then((e=>{t(this.resolveDefaultConfig(e))})).catch(r):t(this.resolveDefaultConfig(e))}))}resolveDefaultConfig(e){const{requestTimeout:t,connectionTimeout:r,socketTimeout:o,socketAcquisitionWarningTimeout:n,httpAgent:s,httpsAgent:i}=e||{};return{connectionTimeout:r,requestTimeout:t??o,socketAcquisitionWarningTimeout:n,httpAgent:s instanceof a.Agent||"function"==typeof s?.destroy?s:new a.Agent({keepAlive:!0,maxSockets:50,...s}),httpsAgent:i instanceof c.Agent||"function"==typeof i?.destroy?i:new c.Agent({keepAlive:!0,maxSockets:50,...i}),logger:console}}destroy(){this.config?.httpAgent?.destroy(),this.config?.httpsAgent?.destroy()}async handle(e,{abortSignal:t}={}){return this.config||(this.config=await this.configProvider),new Promise(((r,o)=>{let i;const d=[],m=async e=>{await i,d.forEach(l.clearTimeout),o(e)};if(!this.config)throw new Error("Node HTTP request handler config is not resolved");if(t?.aborted){const e=new Error("Request aborted");return e.name="AbortError",void m(e)}const y="https:"===e.protocol,g=y?this.config.httpsAgent:this.config.httpAgent;d.push(l.setTimeout((()=>{this.socketWarningTimestamp=p.checkSocketUsage(g,this.socketWarningTimestamp,this.config.logger)}),this.config.socketAcquisitionWarningTimeout??(this.config.requestTimeout??2e3)+(this.config.connectionTimeout??1e3)));const b=function(e){const t=[];for(let r of Object.keys(e).sort()){const o=e[r];if(r=s(r),Array.isArray(o))for(let e=0,n=o.length;e<n;e++)t.push(`${r}=${s(o[e])}`);else{let e=r;(o||"string"==typeof o)&&(e+=`=${s(o)}`),t.push(e)}}return t.join("&")}(e.query||{});let w;null==e.username&&null==e.password||(w=`${e.username??""}:${e.password??""}`);let T=e.path;b&&(T+=`?${b}`),e.fragment&&(T+=`#${e.fragment}`);let E=e.hostname??"";E="["===E[0]&&E.endsWith("]")?e.hostname.slice(1,-1):e.hostname;const A={headers:e.headers,host:E,method:e.method,path:T,port:e.port,agent:g,auth:w},S=(y?c.request:a.request)(A,(e=>{(async e=>{await i,d.forEach(l.clearTimeout),r(e)})({response:new n.Zn({statusCode:e.statusCode||-1,reason:e.statusMessage,headers:u(e.headers),body:e})})}));if(S.on("error",(e=>{f.includes(e.code)?m(Object.assign(e,{name:"TimeoutError"})):m(e)})),t){const e=()=>{S.destroy();const e=new Error("Request aborted");e.name="AbortError",m(e)};if("function"==typeof t.addEventListener){const r=t;r.addEventListener("abort",e,{once:!0}),S.once("close",(()=>r.removeEventListener("abort",e)))}else t.onabort=e}d.push(((e,t,r=0)=>{if(!r)return-1;const o=o=>{const n=l.setTimeout((()=>{e.destroy(),t(Object.assign(new Error(`Socket timed out without establishing a connection within ${r} ms`),{name:"TimeoutError"}))}),r-o),s=e=>{e?.connecting?e.on("connect",(()=>{l.clearTimeout(n)})):l.clearTimeout(n)};e.socket?s(e.socket):e.on("socket",s)};return r<2e3?(o(0),0):l.setTimeout(o.bind(null,1e3),1e3)})(S,m,this.config.connectionTimeout)),d.push(((e,t,r=0)=>{const o=o=>{const n=r-o,s=()=>{e.destroy(),t(Object.assign(new Error(`Connection timed out after ${r} ms`),{name:"TimeoutError"}))};e.socket?(e.socket.setTimeout(n,s),e.on("close",(()=>e.socket?.removeListener("timeout",s)))):e.setTimeout(n,s)};return 0<r&&r<6e3?(o(0),0):l.setTimeout(o.bind(null,0===r?0:3e3),3e3)})(S,m,this.config.requestTimeout));const v=A.agent;"object"==typeof v&&"keepAlive"in v&&d.push(((e,{keepAlive:t,keepAliveMsecs:r},o=3e3)=>{if(!0!==t)return-1;const n=()=>{e.socket?e.socket.setKeepAlive(t,r||0):e.on("socket",(e=>{e.setKeepAlive(t,r||0)}))};return 0===o?(n(),0):l.setTimeout(n,o)})(S,{keepAlive:v.keepAlive,keepAliveMsecs:v.keepAliveMsecs})),i=async function(e,t,r=6e3){const o=t.headers??{},n=o.Expect||o.expect;let s=-1,i=!0;"100-continue"===n&&(i=await Promise.race([new Promise((e=>{s=Number(l.setTimeout((()=>e(!0)),Math.max(6e3,r)))})),new Promise((t=>{e.on("continue",(()=>{l.clearTimeout(s),t(!0)})),e.on("response",(()=>{l.clearTimeout(s),t(!1)})),e.on("error",(()=>{l.clearTimeout(s),t(!1)}))}))])),i&&function(e,t){if(t instanceof h.Readable)t.pipe(e);else{if(t){if(Buffer.isBuffer(t)||"string"==typeof t)return void e.end(t);const r=t;return"object"==typeof r&&r.buffer&&"number"==typeof r.byteOffset&&"number"==typeof r.byteLength?void e.end(Buffer.from(r.buffer,r.byteOffset,r.byteLength)):void e.end(Buffer.from(t))}e.end()}}(e,t.body)}(S,e,this.config.requestTimeout).catch((e=>(d.forEach(l.clearTimeout),o(e))))}))}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then((r=>({...r,[e]:t})))}httpHandlerConfigs(){return this.config??{}}}r(5158);class d{constructor(e){this.sessions=[],this.sessions=e??[]}poll(){if(this.sessions.length>0)return this.sessions.shift()}offerLast(e){this.sessions.push(e)}contains(e){return this.sessions.includes(e)}remove(e){this.sessions=this.sessions.filter((t=>t!==e))}[Symbol.iterator](){return this.sessions[Symbol.iterator]()}destroy(e){for(const t of this.sessions)t===e&&(t.destroyed||t.destroy())}}class m extends h.Writable{constructor(){super(...arguments),this.bufferedBytes=[]}_write(e,t,r){this.bufferedBytes.push(e),r()}}const y=e=>g(e)?async function(e){const t=[],r=e.getReader();let o=!1,n=0;for(;!o;){const{done:e,value:s}=await r.read();s&&(t.push(s),n+=s.length),o=e}const s=new Uint8Array(n);let i=0;for(const e of t)s.set(e,i),i+=e.length;return s}(e):new Promise(((t,r)=>{const o=new m;e.pipe(o),e.on("error",(e=>{o.end(),r(e)})),o.on("error",r),o.on("finish",(function(){const e=new Uint8Array(Buffer.concat(this.bufferedBytes));t(e)}))})),g=e=>"function"==typeof ReadableStream&&e instanceof ReadableStream;class b extends Error{constructor(e,t=!0){let r,o=!0;"boolean"==typeof t?(r=void 0,o=t):null!=t&&"object"==typeof t&&(r=t.logger,o=t.tryNextLink??!0),super(e),this.name="ProviderError",this.tryNextLink=o,Object.setPrototypeOf(this,b.prototype),r?.debug?.(`@smithy/property-provider ${o?"->":"(!)"} ${e}`)}static from(e,t=!0){return Object.assign(new this(e.message,t),e)}}class w extends b{constructor(e,t=!0){super(e,t),this.name="CredentialsProviderError",Object.setPrototypeOf(this,w.prototype)}}var T=r(3292),E=r.n(T),A=r(4300);const S=(e,t=0,r=e.byteLength-t)=>{if(o=e,!("function"==typeof ArrayBuffer&&o instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(o)))throw new TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof e} (${e})`);var o;return A.Buffer.from(e,t,r)},v=(e,t)=>{if("string"!=typeof e)throw new TypeError(`The "input" argument must be of type string. Received type ${typeof e} (${e})`);return t?A.Buffer.from(e,t):A.Buffer.from(e)},R=/^[A-Za-z0-9+/]*={0,2}$/;class O extends Uint8Array{static fromString(e,t="utf-8"){if("string"==typeof e)return transformFromString(e,t);throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}static mutate(e){return Object.setPrototypeOf(e,O.prototype),e}transformToString(e="utf-8"){return transformToString(this,e)}}"function"==typeof ReadableStream&&ReadableStream,r(4492);const k={},C={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),k[e]=t,C[t]=e}const N=e=>"function"==typeof ReadableStream&&(e?.constructor?.name===ReadableStream.name||e instanceof ReadableStream),I="The stream has already been transformed.",$=e=>{if(!x(e)&&!N(e))throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${e?.__proto__?.constructor?.name||e}`);let t=!1;const r=async()=>{if(t)throw new Error(I);return t=!0,await(async e=>"function"==typeof Blob&&e instanceof Blob||"Blob"===e.constructor?.name?void 0!==Blob.prototype.arrayBuffer?new Uint8Array(await e.arrayBuffer()):async function(e){const t=await function(e){return new Promise(((t,r)=>{const o=new FileReader;o.onloadend=()=>{if(2!==o.readyState)return r(new Error("Reader aborted too early"));const e=o.result??"",n=e.indexOf(","),s=n>-1?n+1:e.length;t(e.substring(s))},o.onabort=()=>r(new Error("Read aborted")),o.onerror=()=>r(o.error),o.readAsDataURL(e)}))}(e),r=(e=>{if(3*e.length%4!=0)throw new TypeError("Incorrect padding on base64 string.");if(!R.exec(e))throw new TypeError("Invalid base64 string.");const t=v(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)})(t);return new Uint8Array(r)}(e):async function(e){const t=[],r=e.getReader();let o=!1,n=0;for(;!o;){const{done:e,value:s}=await r.read();s&&(t.push(s),n+=s.length),o=e}const s=new Uint8Array(n);let i=0;for(const e of t)s.set(e,i),i+=e.length;return s}(e))(e)};return Object.assign(e,{transformToByteArray:r,transformToString:async e=>{const t=await r();if("base64"===e)return(e=>{let t;if(t="string"==typeof e?(e=>{const t=v(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)})(e):e,"object"!=typeof t||"number"!=typeof t.byteOffset||"number"!=typeof t.byteLength)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");return S(t.buffer,t.byteOffset,t.byteLength).toString("base64")})(t);if("hex"===e)return function(e){let t="";for(let r=0;r<e.byteLength;r++)t+=k[e[r]];return t}(t);if(void 0===e||"utf8"===e||"utf-8"===e)return(e=>{if("string"==typeof e)return e;if("object"!=typeof e||"number"!=typeof e.byteOffset||"number"!=typeof e.byteLength)throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return S(e.buffer,e.byteOffset,e.byteLength).toString("utf8")})(t);if("function"==typeof TextDecoder)return new TextDecoder(e).decode(t);throw new Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(t)throw new Error(I);if(t=!0,x(e))return(e=>{if("function"!=typeof e.stream)throw new Error("Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.\nIf you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body");return e.stream()})(e);if(N(e))return e;throw new Error(`Cannot transform payload to web stream, got ${e}`)}})},x=e=>"function"==typeof Blob&&e instanceof Blob,P="The stream has already been transformed.";var _,U,L,B,j,D,q,H;!function(e){e.HEADER="header",e.QUERY="query"}(_||(_={})),function(e){e.HEADER="header",e.QUERY="query"}(U||(U={})),function(e){e.HTTP="http",e.HTTPS="https"}(L||(L={})),(j=B||(B={})).MD5="md5",j.CRC32="crc32",j.CRC32C="crc32c",j.SHA1="sha1",j.SHA256="sha256",function(e){e[e.HEADER=0]="HEADER",e[e.TRAILER=1]="TRAILER"}(D||(D={})),function(e){e.PROFILE="profile",e.SSO_SESSION="sso-session",e.SERVICES="services"}(q||(q={})),function(e){e.HTTP_0_9="http/0.9",e.HTTP_1_0="http/1.0",e.TDS_8_0="tds/8.0"}(H||(H={}));const W=Math.ceil(2**127*(2-2**-23)),F=e=>{const t=(e=>{if(null!=e){if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return String(t)!==String(e)&&V.warn(Z(`Expected number but observed string: ${e}`)),t}if("number"==typeof e)return e;throw new TypeError(`Expected number, got ${typeof e}: ${e}`)}})(e);if(void 0!==t&&!Number.isNaN(t)&&t!==1/0&&t!==-1/0&&Math.abs(t)>W)throw new TypeError(`Expected 32-bit float, got ${e}`);return t},M=(e,t)=>{const r=(e=>{if(null!=e){if(Number.isInteger(e)&&!Number.isNaN(e))return e;throw new TypeError(`Expected integer, got ${typeof e}: ${e}`)}})(e);if(void 0!==r&&z(r,t)!==r)throw new TypeError(`Expected ${t}-bit integer, got ${e}`);return r},z=(e,t)=>{switch(t){case 32:return Int32Array.of(e)[0];case 16:return Int16Array.of(e)[0];case 8:return Int8Array.of(e)[0]}},K=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,J=e=>{const t=e.match(K);if(null===t||t[0].length!==e.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(e)},Z=e=>String(new TypeError(e).stack||e).split("\n").slice(0,5).filter((e=>!e.includes("stackTraceWarning"))).join("\n"),V={warn:console.warn},Y=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Q=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?[zZ]$/),G=e=>{if(null==e)return;if("string"!=typeof e)throw new TypeError("RFC-3339 date-times must be expressed as strings");const t=Q.exec(e);if(!t)throw new TypeError("Invalid RFC-3339 date-time value");const[r,o,n,s,i,a,c,f]=t,u=(e=>(e=>M(e,16))("string"==typeof e?J(e):e))(se(o)),l=oe(n,"month",1,12),h=oe(s,"day",1,31);return X(u,l,h,{hours:i,minutes:a,seconds:c,fractionalMilliseconds:f})},X=(e,t,r,o)=>{const n=t-1;return te(e,n,r),new Date(Date.UTC(e,n,r,oe(o.hours,"hour",0,23),oe(o.minutes,"minute",0,59),oe(o.seconds,"seconds",0,60),ne(o.fractionalMilliseconds)))},ee=[31,28,31,30,31,30,31,31,30,31,30,31],te=(e,t,r)=>{let o=ee[t];if(1===t&&re(e)&&(o=29),r>o)throw new TypeError(`Invalid day for ${Y[t]} in ${e}: ${r}`)},re=e=>e%4==0&&(e%100!=0||e%400==0),oe=(e,t,r,o)=>{const n=(e=>(e=>M(e,8))("string"==typeof e?J(e):e))(se(e));if(n<r||n>o)throw new TypeError(`${t} must be between ${r} and ${o}, inclusive`);return n},ne=e=>null==e?0:1e3*(e=>F("string"==typeof e?J(e):e))("0."+e),se=e=>{let t=0;for(;t<e.length-1&&"0"===e.charAt(t);)t++;return 0===t?e:e.slice(t)};class ie extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}static isInstance(e){if(!e)return!1;const t=e;return ie.prototype.isPrototypeOf(t)||Boolean(t.$fault)&&Boolean(t.$metadata)&&("client"===t.$fault||"server"===t.$fault)}static[Symbol.hasInstance](e){if(!e)return!1;const t=e;return this===ie?ie.isInstance(e):!!ie.isInstance(e)&&(t.name&&this.name?this.prototype.isPrototypeOf(e)||t.name===this.name:this.prototype.isPrototypeOf(e))}}const ae=function(e){return Object.assign(new String(e),{deserializeJSON:()=>JSON.parse(String(e)),toString:()=>String(e),toJSON:()=>String(e)})};ae.from=e=>e&&"object"==typeof e&&(e instanceof ae||"deserializeJSON"in e)?e:"string"==typeof e||Object.getPrototypeOf(e)===String.prototype?ae(String(e)):ae(JSON.stringify(e)),ae.fromObject=ae.from;const ce=(e={})=>{let t;e.logger?.debug("@aws-sdk/credential-provider-http - fromHttp");const r=e.awsContainerCredentialsRelativeUri??process.env.AWS_CONTAINER_CREDENTIALS_RELATIVE_URI,s=e.awsContainerCredentialsFullUri??process.env.AWS_CONTAINER_CREDENTIALS_FULL_URI,i=e.awsContainerAuthorizationToken??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN,a=e.awsContainerAuthorizationTokenFile??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE,c="NoOpLogger"!==e.logger?.constructor?.name&&e.logger?e.logger.warn:console.warn;if(r&&s&&(c("@aws-sdk/credential-provider-http: you have set both awsContainerCredentialsRelativeUri and awsContainerCredentialsFullUri."),c("awsContainerCredentialsFullUri will take precedence.")),i&&a&&(c("@aws-sdk/credential-provider-http: you have set both awsContainerAuthorizationToken and awsContainerAuthorizationTokenFile."),c("awsContainerAuthorizationToken will take precedence.")),s)t=s;else{if(!r)throw new w("No HTTP credential provider host provided.\nSet AWS_CONTAINER_CREDENTIALS_FULL_URI or AWS_CONTAINER_CREDENTIALS_RELATIVE_URI.",{logger:e.logger});t=`http://169.254.170.2${r}`}const f=new URL(t);((e,t)=>{if("https:"!==e.protocol&&"169.254.170.2"!==e.hostname&&"169.254.170.23"!==e.hostname&&"[fd00:ec2::23]"!==e.hostname){if(e.hostname.includes("[")){if("[::1]"===e.hostname||"[0000:0000:0000:0000:0000:0000:0000:0001]"===e.hostname)return}else{if("localhost"===e.hostname)return;const t=e.hostname.split("."),r=e=>{const t=parseInt(e,10);return 0<=t&&t<=255};if("127"===t[0]&&r(t[1])&&r(t[2])&&r(t[3])&&4===t.length)return}throw new w("URL not accepted. It must either be HTTPS or match one of the following:\n  - loopback CIDR 127.0.0.0/8 or [::1/128]\n  - ECS container host 169.254.170.2\n  - EKS container host 169.254.170.23 or [fd00:ec2::23]",{logger:t})}})(f,e.logger);const u=new p({requestTimeout:e.timeout??1e3,connectionTimeout:e.timeout??1e3});return l=async()=>{const t=function(e){return new n.aW({protocol:e.protocol,hostname:e.hostname,port:Number(e.port),path:e.pathname,query:Array.from(e.searchParams.entries()).reduce(((e,[t,r])=>(e[t]=r,e)),{}),fragment:e.hash})}(f);i?t.headers.Authorization=i:a&&(t.headers.Authorization=(await E().readFile(a)).toString());try{return async function(e,t){const r=(e=>{if(!(e instanceof h.Readable))try{return $(e)}catch(t){throw new Error(`Unexpected stream implementation, expect Stream.Readable instance, got ${e?.__proto__?.constructor?.name||e}`)}let t=!1;const r=async()=>{if(t)throw new Error(P);return t=!0,await y(e)};return Object.assign(e,{transformToByteArray:r,transformToString:async e=>{const t=await r();return void 0===e||Buffer.isEncoding(e)?S(t.buffer,t.byteOffset,t.byteLength).toString(e):new TextDecoder(e).decode(t)},transformToWebStream:()=>{if(t)throw new Error(P);if(null!==e.readableFlowing)throw new Error("The stream has been consumed by other callbacks.");if("function"!=typeof h.Readable.toWeb)throw new Error("Readable.toWeb() is not supported. Please ensure a polyfill is available.");return t=!0,h.Readable.toWeb(e)}})})(e.body),o=await r.transformToString();if(200===e.statusCode){const e=JSON.parse(o);if("string"!=typeof e.AccessKeyId||"string"!=typeof e.SecretAccessKey||"string"!=typeof e.Token||"string"!=typeof e.Expiration)throw new w("HTTP credential provider response not of the required format, an object matching: { AccessKeyId: string, SecretAccessKey: string, Token: string, Expiration: string(rfc3339) }",{logger:t});return{accessKeyId:e.AccessKeyId,secretAccessKey:e.SecretAccessKey,sessionToken:e.Token,expiration:G(e.Expiration)}}if(e.statusCode>=400&&e.statusCode<500){let r={};try{r=JSON.parse(o)}catch(e){}throw Object.assign(new w(`Server responded with status: ${e.statusCode}`,{logger:t}),{Code:r.Code,Message:r.Message})}throw new w(`Server responded with status: ${e.statusCode}`,{logger:t})}((await u.handle(t)).response).then((e=>(0,o.P)(e,"CREDENTIALS_HTTP","z")))}catch(t){throw new w(String(t),{logger:e.logger})}},d=e.maxRetries??3,m=e.timeout??1e3,async()=>{for(let e=0;e<d;++e)try{return await l()}catch(e){await new Promise((e=>setTimeout(e,m)))}return await l()};var l,d,m}}};